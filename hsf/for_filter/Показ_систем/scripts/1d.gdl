show_all_system = 1 : success = LIBRARYGLOBAL ("Libraryflobals-mep", "show_all_system", show_all_system)show_el = 0if show_all_system then	show_el = 1	goto "end_show_system"endifdim show_system[] : show_system[1] = ""success = LIBRARYGLOBAL ("Libraryflobals-mep", "show_system", show_system)if isMep then	ConID = 1	syst_name = "!!!"	DIM SystemStr[][]	queryStr = "GetMEPSystems (" + STR(ConToolType_1, 1, 0) + ")"	isSystemQuery = APPLICATION_QUERY ("MEPSystem", queryStr, SystemStr)	num = VARDIM2(SystemStr)/2	FOR i = 2 TO num + 1		IF MEP_StrConnectionData[1][2] = SystemStr[1][(i-1)*2-1] THEN syst_name = SystemStr[1][(i-1)*2]	NEXT i		if syst_name = "!!!" then		queryStr = "GetMEPSystems (" + STR(2, 1, 0) + ")"		isSystemQuery = APPLICATION_QUERY ("MEPSystem", queryStr, SystemStr)		num = VARDIM2(SystemStr)/2		FOR i = 2 TO num + 1			IF MEP_StrConnectionData[1][2] = SystemStr[1][(i-1)*2-1] THEN syst_name = SystemStr[1][(i-1)*2]		NEXT i	endifendiffor i=1 to vardim1(show_system)	usl1 =(show_system[i]=syst_name)	if STRSUB(show_system[i], 1, 1) = "*" and not(usl1) then !Если сборка начинается с * - отсекаем, и ищем конец		findsp = STRSUB(show_system[i], 2, STRLEN(show_system[i]))		if STRLEN(syst_name)>=STRLEN(findsp) then !Если имя сборки меньше длины искомого текста - она явно не подходит			findsp_t = STRSUB(syst_name,STRLEN(syst_name)-STRLEN(findsp)+1,STRLEN(findsp))			usl1 = (findsp_t=findsp)		else			usl1 = 0		endif	endif	if STRSUB(show_system[i], STRLEN(show_system[i]), 1) = "*" and not(usl1) then !Если сборка заканчивается на * - отсекаем, и ищем начало		findsp = STRSUB(show_system[i], 1, STRLEN(show_system[i])-1)		if STRLEN(syst_name)>=STRLEN(findsp) then !Если имя сборки меньше длины искомого текста - она явно не подходит			findsp_t = STRSUB(syst_name,1,STRLEN(findsp))			usl1 = (findsp_t=findsp)		else			usl1 = 0		endif	endif	if STRSUB(show_system[i], 1, 1) = "*" and STRSUB(show_system[i], STRLEN(show_system[i]), 1) = "*" and not(usl1) then !Ищем вхождение		findsp = STRSUB(show_system[i], 2, STRLEN(show_system[i])-2)		usl1 = (STRSTR(syst_name, findsp, 1)>0)	endif	if STRSUB(show_system[i], 1, 1) = "*" and STRLEN(show_system[i])=1 and not(usl1) then !Все сборки		usl1 = 1	endif	if usl1 then show_el = 1	if show_el=1 then i=vardim1(show_system)next i"end_show_system":	if isMep then		end show_el, syst_name	else		end show_el	endif