<?xml version="1.0" encoding="UTF-8"?>
<Symbol IsArchivable="false" IsPlaceable="false" MainGUID="88E821BC-A95F-4CEA-9F73-6500A781AE09" MigrationValue="Normal" Owner="1196638531" Signature="776425555" Version="38">
<Ancestry SectVersion="1" SectionFlags="0" SubIdent="0" Template="true">
	<MainGUID>F938E33A-329D-4A36-BE3E-85E126820996</MainGUID>
	<MainGUID>8F157ABA-E5C9-48B6-9DCE-68F0F02A808E</MainGUID>
</Ancestry>

<CalledMacros SectVersion="2" SectionFlags="0" SubIdent="0">
	<Macro>
		<MName><![CDATA["Показ_по_сборкам"]]></MName>
		<MainGUID>8CE26AA8-652F-4D4A-95D8-E7E763E145D4</MainGUID>
	</Macro>
	<Macro>
		<MName><![CDATA["Libraryflobals-km"]]></MName>
		<MainGUID>2087989F-7AAB-43CC-9F4A-8CC8975EA122</MainGUID>
	</Macro>
</CalledMacros>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_2D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_2D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_1D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
DIM t[]
DIM name_elev_ar[]
DIM size_elev_ar[][]
DIM numb_elev_ar[]

!!=============== Общие параметры ===================
!subpos = ""		!ID сборки
!pos = ""			!Позиция элемента, обычно pos=GLOB_ID
!gid = ""           !Уникальный индентификатор, для перенумерации в экселе
!obozn = ""			!Обозначение. Ссылка на ГОСТ или лист
!naen = ""			!Наименование
!ves = 0			!Масса ед., кг.
!kol_vo_spec = 0 	!Количество
!komment = ""		!Примечание
!!===================================================


!!=================== Примеры =======================

!!------ Арматура -----------------------------------------------------------------
!subpos = ""		!ID сборки
!pos = ""			!Позиция элемента, обычно pos=GLOB_ID
!marka = ""			!Класс арматуры
!diam_arm = 0		!Диаметр, м
!dlin_st = 0		!Длина стержня, м
!kol_vo_spec = 0	!Кол-во стержней
!fon = 0			!=1 Для арматуры в п.м.
!plit = 0			!=1 Для аксессуаров
!gnut = 0			!=1 Для гнутых стержней
!call "Спецификатор" parameters tip_el="10",
!								subpos=subpos, 
!								pos=pos,
!								marka=marka,
!								diam_arm=diam_arm,
!								dlin_st=dlin_st,
!								kol_vo_spec=kol_vo_spec,
!								fon=fon,
!								plit=plit,
!								gnut=gnut
!!---------------------------------------------------------------------------------

!!------ Прокат -------------------------------------------------------------------
!subpos = ""		!ID сборки
!pos = ""			!Позиция элемента, обычно pos=GLOB_ID
!obozn = ""			!Обозначение. Ссылка на ГОСТ или лист
!ves = 0			!Масса ед., кг.
!kol_vo_spec = 0 	!Количество
!komment = ""		!Примечание
!tip_konstr = ""	!Тип конструкции для технической спецификации (Колонны, Балки и т.д.)
!mater = ""			!Марка стали
!tip_profile = ""	!Типоразмер профиля. Для листов должно начинаться с "--"
!dlin_prof = 0		!Длина профиля, м.
!naen = ""			!Для листов, фасонок - в формате "--ТОЛЩИНАхШИРИНАхДЛИНА"
!call "Спецификатор" parameters tip_el=tip_el,
!								subpos=subpos, 
!								pos=pos,
!								tip_konstr=tip_konstr,
!								stal_gost="-",
!								mater=mater,
!								obozn=obozn,
!								tip_profile=tip_profile,
!								dlin_prof=dlin_prof,
!								ves=ves/dlin_prof,
!								naen=naen
!!---------------------------------------------------------------------------------

!!------ Материал -----------------------------------------------------------------
!!У материалов отсутвуют позиции, все одинаковые материалы складываются автоматически
!subpos = ""		!ID сборки
!pos = ""			!Позиция элемента, обычно pos=GLOB_ID
!obozn = ""			!Обозначение. Ссылка на ГОСТ или лист
!ves = 0			!Масса ед., кг.
!komment = ""		!Единицы измерения. Возможные значения - кв.м., куб.м., кг., л и т.д.
!kol_vo_spec = 0	!Количество материала в ед.изм
!call "Спецификатор" parameters tip_el="30",
!								subpos=subpos, 
!								obozn=obozn,
!								naen=naen,
!								kol_vo_spec=kol_vo_spec,
!								ves=ves,
!								komment=komment
!!---------------------------------------------------------------------------------

!!------ Окраска ------------------------------------------------------------------
!subpos = ""		!ID сборки
!pos = ""			!Позиция элемента, обычно pos=GLOB_ID
!obozn = ""			!Обозначение. Ссылка на ГОСТ или лист
!naen = ""			!Наименование
!ves = 0			!Масса ед., кг.
!komment = "кв.м."		
!kol_vo_spec = 0	!Площадь окраски в кв.м.
!call "Спецификатор" parameters tip_el="30",
!								subpos=subpos, 
!								obozn=obozn,
!								naen=naen,
!								kol_vo_spec=kol_vo_spec,
!								komment=komment
!!---------------------------------------------------------------------------------

!!------ Бетоны всякие ------------------------------------------------------------
!subpos = ""		!ID сборки
!pos = ""			!Позиция элемента, обычно pos=GLOB_ID
!obozn = ""			!Обозначение. Ссылка на ГОСТ или лист
!naen = ""			!Наименование
!ves = 0			!Масса ед., кг.
!komment = "куб.м."		
!kol_vo_spec = 0	!Объём в куб.м.
!call "Спецификатор" parameters tip_el="30",
!								subpos=subpos, 
!								obozn=obozn,
!								naen=naen,
!								kol_vo_spec=kol_vo_spec,
!								komment=komment
!!---------------------------------------------------------------------------------

!!------ Изделие ------------------------------------------------------------------
!subpos = ""		!ID сборки
!pos = ""			!Позиция элемента, обычно pos=GLOB_ID
!obozn = ""			!Обозначение. Ссылка на ГОСТ или лист
!naen = ""			!Наименование
!ves = 0			!Масса ед., кг.
!kol_vo_spec = 0 	!Количество
!komment = ""		!Примечание. Если содержит "п.м." одинаковые изделия суммируются
!call "Спецификатор" parameters tip_el="40",
!								subpos=subpos, 
!								pos=pos, 
!								obozn=obozn,
!								naen=naen,
!								ves=ves,
!								kol_vo_spec=kol_vo_spec,
!								komment=komment
!!----------------------------------------------------------------------------------

!!------ Деревянный элемент, в п.м. ------------------------------------------------
!subpos = ""		!ID сборки
!pos = ""			!Позиция элемента, обычно pos=GLOB_ID
!obozn = ""			!Обозначение. Ссылка на ГОСТ или лист
!naen = ""			!Наименование
!l_wood = 0			!Длина, м
!h_wood = 0			!Высота, м
!b_wood = 0			!Ширина, м
!call "Спецификатор" parameters tip_el="40",
!								subpos=subpos, 
!								pos=pos, 
!								obozn=obozn,
!								naen=naen,
!								ves=0,
!								kol_vo_spec=l_wood,
!								komment="п.м."+"#дерев"+str("%.2", h_wood*b_wood*1000)
!!---------------------------------------------------------------------------------

!!------ Сборочная единица --------------------------------------------------------
!!Масса вычисляется автоматически
!subpos = ""		!ID сборки
!obozn = ""			!Обозначение. Ссылка на ГОСТ или лист
!naen = ""			!Наименование
!kol_vo_spec = 0 	!Количество
!komment = ""		!Примечание
!call "Спецификатор" parameters tip_el="45",
!								subpos=subpos, 
!								pos=subpos, 
!								obozn=obozn,
!								naen=naen,
!								kol_vo_spec=kol_vo_spec,
!								komment=komment
!!---------------------------------------------------------------------------------

!!------ Вложенная сборочная единица ----------------------------------------------
!!Масса вычисляется автоматически
!subpos = ""		!ID основной сборки
!obozn = ""			!Обозначение. Ссылка на ГОСТ или лист
!naen = ""			!Наименование
!kol_vo_spec = 0 	!Количество
!komment = ""		!Примечание
!pos_det = ""
!subpos_delim = "'"
!subpos_det = subpos + subpos_delim + pos_det
!call "Спецификатор" parameters tip_el="45",
!								subpos=subpos_det, 
!								pos=pos_det, 
!								obozn=obozn,
!								naen=naen,
!								kol_vo_spec=kol_vo_spec,
!								komment=komment
!!---------------------------------------------------------------------------------

!!------ Заполнение оконного проёма -----------------------------------------------
!subpos = ""		!ID сборки
!pos = ""			!Позиция элемента, обычно pos=GLOB_ID
!obozn = ""			!Обозначение. Ссылка на ГОСТ или лист
!naen = ""			!Наименование
!ves = 0			!Масса ед., кг.
!kol_vo_spec = 0 	!Количество
!komment = ""		!Примечание
!area_zap = 0		!Площадь, кв.м.
!call "Спецификатор" parameters tip_el="60",
!								subpos=subpos,
!								pos="окно"+pos,
!								obozn=obozn,
!								naen=naen,
!								ves=ves,
!								kol_vo_spec=kol_vo_spec,
!								komment=komment, spec_add_param = "@S="+str("%.2",area_zap)
!!---------------------------------------------------------------------------------

!!------ Заполнение дверного проёма -----------------------------------------------
!subpos = ""		!ID сборки
!pos = ""			!Позиция элемента, обычно pos=GLOB_ID
!obozn = ""			!Обозначение. Ссылка на ГОСТ или лист
!naen = ""			!Наименование
!ves = 0			!Масса ед., кг.
!kol_vo_spec = 0 	!Количество
!komment = ""		!Примечание
!area_zap = 0		!Площадь, кв.м.
!call "Спецификатор" parameters tip_el="60",
!								subpos=subpos,
!								pos="дверь"+pos,
!								obozn=obozn,
!								naen=naen,
!								ves=ves,
!								kol_vo_spec=kol_vo_spec,
!								komment=komment, spec_add_param = "@S="+str("%.2",area_zap)
!!---------------------------------------------------------------------------------

!!------ Фурнитура заполнения проёма (подоконники, отливы и т.д.)------------------
!subpos = ""		!ID сборки
!pos = ""			!Позиция элемента, обычно pos=GLOB_ID
!obozn = ""			!Обозначение. Ссылка на ГОСТ или лист
!naen = ""			!Наименование
!ves = 0			!Масса ед., кг.
!kol_vo_spec = 0 	!Количество
!komment = ""		!Примечание
!call "Спецификатор" parameters tip_el="60",
!								subpos=subpos,
!								pos=pos, 
!								obozn=obozn,
!								naen=naen,
!								ves=ves,
!								kol_vo_spec=kol_vo_spec,
!								komment=komment
!!---------------------------------------------------------------------------------


!!===================================================
]]>
</Script_1D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_PR SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
var_t = ""
var = ""
EPS = 0.000025
rz = ";"
control_sum = "-"
n = 0

success = LIBRARYGLOBAL ("Libraryflobals-km", "ignore_id", ignore_id)
spec_ignore = 0

IF STRSTR (pos, ignore_id, 1) > 0 THEN spec_ignore = 1
IF STRSTR (subpos, ignore_id, 1) > 0 THEN spec_ignore = 1
show_marker = 1 : show_subpos = 1 : call "Показ_по_сборкам" PARAMETERS ALL subpos=subpos, pos=pos RETURNED_PARAMETERS show_subpos, show_marker
if show_subpos = 0 and show_marker = 0 THEN spec_ignore = 1

version = 3

if not(spec_ignore) then
	if version = 2 then
		n = REQUEST ("STORY_INFO", "", nelev, t)
		FOR i = 1 TO nelev
			numb_elev_ar[i] = t [4 * (i - 1) + 1]
			name_elev_ar[i] = t [4 * (i - 1) + 2]
			size_elev_ar[i][1] = t [4 * (i - 1) + 3]
			size_elev_ar[i][2] = size_elev_ar[i][1] + t [4 * (i - 1) + 4]
		NEXT i
		inx_elev = -1
		if mun_elev and abs(n_elev)<=abs(nelev) then
			FOR i = 1 TO nelev
				if numb_elev_ar[i]=n_elev then inx_elev = i
			next i
		endif
		if inx_elev = -1 then
			FOR i = 1 TO nelev
				if otm_elem >= size_elev_ar[i][1] and otm_elem<size_elev_ar[i][2] then inx_elev = i
			next i
		endif
		if inx_elev = -1 then
			if otm_elem >= size_elev_ar[nelev][1] or otm_elem>=size_elev_ar[nelev][2] then inx_elev = nelev
		endif
		if inx_elev = -1 then
			if otm_elem <= size_elev_ar[1][1] or otm_elem<=size_elev_ar[1][2] then inx_elev = 1
		endif
		if inx_elev = -1 then
			n_elev = 99
			elem_elev="ОЭ"
		else
			n_elev = numb_elev_ar[inx_elev]
			elem_elev = name_elev_ar[inx_elev]
		endif
		!Если имя этажа слишком длинной - оставим только хвост
		characters_number = 10
		if STRLEN(elem_elev)>characters_number then
			elem_elev = STRSUB (elem_elev, STRLEN(elem_elev)-characters_number, characters_number+1)
		endif
		!Переводим все числовые значения в текст, обрезаем нулив конце
		n_elev_txt = str("%.0",n_elev)
	endif
	if version >= 3 then
		elem_elev="-"
		n_elev_txt = "-"
	endif
	if version = 4 then
		if gid="" or gid=" " then gid = pos
	else
		gid = " "
	endif

	if abs(otm_elem) < EPS then 
		otm_elem_t = "0"
	else
		var = STR("%.3m", otm_elem) : gosub "del_zero" : otm_elem_t = var_t
	endif	
	if ves < EPS then 
		ves_t = "-"
	else
		var = str("%.3",ves) : gosub "del_zero" : ves_t = var_t
	endif
	if kol_vo_spec<EPS then
		kol_vo_txt = "1"
	else
		var = str("%.3",kol_vo_spec) : gosub "del_zero" : kol_vo_txt = var_t
	endif
	if vartype(subpos) = 1 then subpos = str("%.0",subpos)
	if vartype(pos) = 1 then pos = str("%.0",pos)
	if vartype(marka) = 1 then marka = "!"
	if vartype(obozn) = 1 then obozn = "!"
	if vartype(naen) = 1 then naen = "!"
	if vartype(komment) = 1 then komment = "!"
	if vartype(spec_add_param) = 1 then spec_add_param = "-"
	if subpos = "" then subpos = "-"
	if subpos = " " then subpos = "-"
	if subpos = "!" then subpos = "-"
	if pos="" then pos = "-"
	if marka="" then marka = "-"
	if obozn="" then obozn = "-"
	if naen="" then naen = "-"
	if komment="" then komment = "-"

	spec_add_param = "v"+STR("%.0", version)+"%%" + spec_add_param

!-------------------------------------------------
!------------------- Арматура --------------------
	if tip_el = "10" then
		r_arm = diam_arm/2
		if diam_arm<EPS then 
			diam_arm_txt = "!"
		else
			diam_arm_txt = str("%.0mm",diam_arm)
		endif
		if dlin_st<EPS then
			dlin_txt = "!"
		else
			dlin_txt = str("%.0mm", dlin_st)
		endif
		str_out = subpos + rz !Сборочная позиция
		str_out = str_out + tip_el + rz !Тип элемента
		str_out = str_out + pos + rz !Позиция
		str_out = str_out + n_elev_txt + rz !Номер этажа
		str_out = str_out + elem_elev + rz !Этаж
		str_out = str_out + spec_add_param + rz !Доп. параметры
		str_out = str_out + marka + rz !Класс
		str_out = str_out + diam_arm_txt + rz !Диаметр
		str_out = str_out + dlin_txt + rz !Длина
		str_out = str_out + kol_vo_txt + rz !Количество
		fon_txt = str("%.0",fon) : str_out = str_out + fon_txt + rz !Погонаж ли
		plit_txt = str("%.0",plit) : str_out = str_out + plit_txt + rz !Фон ли плиты
		gnut_txt = str("%.0",gnut) : str_out = str_out + gnut_txt + rz !Гнутый ли стержень
		str_out = str_out + control_sum !Контрольная сумма
		COMPONENT str_out, dlin_st * r_arm * r_arm * PI * 1000, gid
	else
		n = n + 1
	endif
!-------------------------------------------------

!-------------------------------------------------
!--------------------- Прокат --------------------
	if tip_el = "20" then
		if vartype(tip_konstr) = 1 then tip_konstr = "!"
		if vartype(tip_profile) = 1 then tip_profile = "!"
		if vartype(mater) = 1 then mater = "!"
		if dlin_prof>EPS and STRSTR(tip_profile, "--")=0 and STRSTR(naen, "--")=0 then
			dlin_prof = round_int(dlin_prof*1000)/1000
		endif
		if dlin_prof<EPS then 
			dlin_prof_txt = "-"
		else
			var = str("%.6mm",dlin_prof) : gosub "del_zero" : dlin_prof_txt = var_t
			if dlin_prof>0.0001 then
				var = str("%.6mm",dlin_prof)
			else
				var = str("%.6mm",dlin_prof)
			endif
		endif
		characters_number = 20
		if STRLEN(naen)>characters_number then naen = STRSUB (naen, 1, characters_number)
		str_out = subpos + rz !Сборочная позиция  
		str_out = str_out + tip_el + rz !Тип элемента
		str_out = str_out + pos + rz !Позиция
		str_out = str_out + n_elev_txt + rz !Номер этажа
		str_out = str_out + elem_elev + rz !Этаж
		str_out = str_out + spec_add_param + rz !Доп. параметры
		str_out = str_out + tip_konstr + rz !Тип конструкции
		str_out = str_out + "-" + rz !ГОСТ на сталь
		str_out = str_out + mater + rz !Сталь
		str_out = str_out + kol_vo_txt + rz !Количество (=1 для обычных библ. элементов)
		str_out = str_out + obozn + rz !ГОСТ на профиль
		str_out = str_out + tip_profile + rz !Профиль
		str_out = str_out + dlin_prof_txt + rz !Длина
		str_out = str_out + control_sum + rz !Контрольная сумма
		str_out = str_out + ves_t+ rz !Вес погонный
		str_out = str_out + naen !Наименование
		COMPONENT str_out, ves, gid
	else
		n = n + 1
	endif
!-------------------------------------------------

!-------------------------------------------------
!-------------------- Изделия --------------------
	if tip_el = "40" then
		str_out = subpos + rz !Сборочная позиция  
		str_out = str_out + tip_el + rz !Тип элемента
		str_out = str_out + pos + rz !Позиция
		str_out = str_out + n_elev_txt + rz !Номер этажа
		str_out = str_out + elem_elev + rz !Этаж
		str_out = str_out + spec_add_param + rz !Доп. параметры
		str_out = str_out + obozn + rz !Обозначение
		str_out = str_out + naen + rz !Наименование
		str_out = str_out + ves_t + rz !Вес
		str_out = str_out + kol_vo_txt + rz !
		str_out = str_out + komment !
		COMPONENT str_out, kol_vo_spec, gid
	else
		n = n + 1
	endif
!-------------------------------------------------

!-------------------------------------------------
!------------------- Материал --------------------
	if tip_el = "30" then
		str_out = subpos + rz !Сборочная позиция  
		str_out = str_out + tip_el + rz !Тип элемента
		str_out = str_out + " " + rz !Позиция
		str_out = str_out + n_elev_txt + rz !Номер этажа
		str_out = str_out + elem_elev + rz !Этаж
		str_out = str_out + spec_add_param + rz !Доп. параметры
		str_out = str_out + obozn + rz !Обозначение
		str_out = str_out + naen + rz !Наименование
		str_out = str_out + "-" + rz !Вес
		str_out = str_out + kol_vo_txt + rz !Обозначение
		str_out = str_out + komment !Наименование
		COMPONENT str_out, kol_vo_spec, gid
	else
		n = n + 1
	endif
!-------------------------------------------------

!-------------------------------------------------
!------------ Маркировка сборки ------------------
	if tip_el = "45" then
		str_out = subpos + rz !Сборочная позиция  
		str_out = str_out + tip_el + rz !Тип элемента
		str_out = str_out + subpos + rz !Позиция
		str_out = str_out + n_elev_txt + rz !Номер этажа
		str_out = str_out + elem_elev + rz !Этаж
		str_out = str_out + spec_add_param + rz !Доп. параметры
		str_out = str_out + obozn + rz !Обозначение
		str_out = str_out + naen + rz !Наименование
		str_out = str_out + "-" + rz !Вес
		str_out = str_out + kol_vo_txt + rz !
		str_out = str_out + komment !
		COMPONENT str_out, kol_vo_spec, gid
	else
		n = n + 1
	endif
!-------------------------------------------------

!-------------------------------------------------
!----------- Заполнение проёмов ------------------
	if tip_el = "60" then
		str_out = subpos + rz !Сборочная позиция
		str_out = str_out + tip_el + rz !Тип элемента
		str_out = str_out + pos + rz !Позиция
		str_out = str_out + n_elev_txt + rz !Номер этажа
		str_out = str_out + elem_elev + rz !Этаж
		str_out = str_out + spec_add_param + rz !Доп. параметры
		str_out = str_out + obozn + rz !Обозначение
		str_out = str_out + naen + rz !Наименование
		str_out = str_out + ves_t + rz !Вес
		str_out = str_out + kol_vo_txt + rz !Количество
		str_out = str_out + komment !Комментарий
		COMPONENT str_out, 1, gid
	else
		n = n + 1
	endif
!-------------------------------------------------

!-------------------------------------------------
!---- Элементы для пятиграфки смежников ----------
	if tip_el = "80" then
		if eq_code>EPS then
			eq_code = str("%.0",eq_code)
		else
			eq_code = "-"
		endif
		str_out = subpos + rz !Сборочная позиция
		str_out = str_out + tip_el + rz !Тип элемента
		str_out = str_out + pos + rz !Позиция
		str_out = str_out + n_elev_txt + rz !Номер этажа
		str_out = str_out + elem_elev + rz !Этаж
		str_out = str_out + spec_add_param + rz !Доп. параметры
		str_out = str_out + obozn + rz !Обозначение
		str_out = str_out + naen + rz !Наименование
		str_out = str_out + ves_t + rz !Вес
		str_out = str_out + kol_vo_txt + rz !Количество
		str_out = str_out + komment !Комментарий
		str_out = str_out + eq_code + rz !Код
		str_out = str_out + eq_plant !Комментарий
		COMPONENT str_out, 1, gid
	else
		n = n + 1
	endif
!-------------------------------------------------

!-------------------------------------------------
!------------- Элементы перемычки ----------------
	if tip_el = "71" then
		spec_add_param = spec_add_param + "@Z="+otm_elem_t
		str_out = subpos + rz !Сборочная позиция  
		str_out = str_out + tip_el + rz !Тип элемента
		str_out = str_out + pos + rz !Позиция
		str_out = str_out + n_elev_txt + rz !Номер этажа
		str_out = str_out + elem_elev + rz !Этаж
		str_out = str_out + spec_add_param + rz !Доп. параметры
		str_out = str_out + obozn + rz !Обозначение
		str_out = str_out + naen + rz !Наименование
		str_out = str_out + ves_t + rz !Вес
		str_out = str_out + kol_vo_txt + rz !
		str_out = str_out + komment !
		COMPONENT str_out, kol_vo_spec, gid
	else
		n = n + 1
	endif
!-------------------------------------------------

!-------------------------------------------------
!------------ Маркировка перемычки ---------------
	if tip_el = "70" then
		spec_add_param = spec_add_param + "@Z="+otm_elem_t
		str_out = subpos + rz !Сборочная позиция  
		str_out = str_out + tip_el + rz !Тип элемента
		str_out = str_out + subpos + rz !Позиция
		str_out = str_out + n_elev_txt + rz !Номер этажа
		str_out = str_out + elem_elev + rz !Этаж
		str_out = str_out + spec_add_param + rz !Доп. параметры
		str_out = str_out + obozn + rz !Обозначение
		str_out = str_out + naen + rz !Наименование
		str_out = str_out + "-" + rz !Вес
		str_out = str_out + kol_vo_txt + rz !
		str_out = str_out + komment !
		COMPONENT str_out, kol_vo_spec, gid
	else
		n = n + 1
	endif
!-------------------------------------------------


endif
end
"addvar":
	control_sum = "-"
return

"del_zero":
	var_t = var
!	var_t = ""
!	if STRSTR(var, ".")> 0 or STRSTR(var, ",")> 0 then
!		for i=strlen(var) to 1 step -1
!			z = strsub(var,i,1)
!			if z<>"0" or z="." or z="," then 
!				var_t = strsub(var,1,i-1*(i=strlen(var)-1)-1*(i=strlen(var)))
!			endif
!			if var_t <> "" then i = 1
!		next i
!		fval = 1 : eval = 2
!		n1 = SPLIT (var_t, "%n", fval)
!		n2 = SPLIT (var, "%n", eval)
!		if n1<>1 or n2<>1 or fval<>eval then var_t = var !Фокус не удался
!	else
!		var_t = var
!	endif
return



]]>
</Script_PR>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_UI SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_UI>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_VL SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_VL>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_FWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_FWM>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_BWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_BWM>

<ParamSection SectVersion="26" SectionFlags="0" SubIdent="0">
	<ParamSectHeader>
		<Version>26</Version>
		<AutoHotspots>false</AutoHotspots>
		<WDLeftFrame>0</WDLeftFrame>
		<WDRightFrame>0</WDRightFrame>
		<WDTopFrame>0</WDTopFrame>
		<WDBotFrame>0</WDBotFrame>
		<LayFlags>65535</LayFlags>
		<WDMirrorThickness>0</WDMirrorThickness>
		<WDWallInset>0</WDWallInset>
		<SymbolColor>0</SymbolColor>
	</ParamSectHeader>
	<Parameters>
		<String Name="gid">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>

		<!-- _sp0: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="_sp0">
			<Description><![CDATA["Арматура"]]></Description>
		</Title>
		<Length Name="diam_arm">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Length>
		<Integer Name="nstolb">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Integer>
		<Length Name="dlin_st">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Length>
		<Boolean Name="fon">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="plit">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gnut">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Boolean>
		<String Name="marka">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>

		<!-- _sp1: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="_sp1">
			<Description><![CDATA["Металл"]]></Description>
		</Title>
		<Integer Name="n_konstr">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Integer>
		<Integer Name="n_stroki">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Integer>
		<Integer Name="n_sort">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Integer>
		<Integer Name="n_stal">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Integer>
		<Length Name="dlin_prof">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Length>
		<String Name="tip_konstr">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="stal_gost">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="mater">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="tip_profile">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>

		<!-- _sp2: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="_sp2">
			<Description><![CDATA["Общие"]]></Description>
		</Title>
		<Boolean Name="mun_elev">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Boolean>
		<Integer Name="n_elev">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Integer>
		<Length Name="otm_elem">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Length>
		<String Name="spec_add_param">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="tip_el">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="subpos">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="pos">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="obozn">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="naen">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<RealNum Name="kol_vo_spec">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ves">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</RealNum>
		<String Name="komment">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>

		<!-- _sp3: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="_sp3">
			<Description><![CDATA["Перемычка"]]></Description>
		</Title>
		<Length Name="koord">
			<Description><![CDATA[""]]></Description>
			<ArrayValues FirstDimension="7" SecondDimension="2">
				<AVal Column="1" Row="1">0</AVal>
				<AVal Column="2" Row="1">0</AVal>
				<AVal Column="1" Row="2">0</AVal>
				<AVal Column="2" Row="2">0</AVal>
				<AVal Column="1" Row="3">0</AVal>
				<AVal Column="2" Row="3">0</AVal>
				<AVal Column="1" Row="4">0</AVal>
				<AVal Column="2" Row="4">0</AVal>
				<AVal Column="1" Row="5">0</AVal>
				<AVal Column="2" Row="5">0</AVal>
				<AVal Column="1" Row="6">0</AVal>
				<AVal Column="2" Row="6">0</AVal>
				<AVal Column="1" Row="7">0</AVal>
				<AVal Column="2" Row="7">0</AVal>
			</ArrayValues>
		</Length>
		<String Name="otm_ved">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="pos_on_marka">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="pos_on_spec">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>

		<!-- _sp5_A: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="_sp5_A">
			<Description><![CDATA["Заполнения окон, дверей"]]></Description>
		</Title>
		<String Name="elem_elev">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>

		<!-- _sp4: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="_sp4">
			<Description><![CDATA["Зона"]]></Description>
		</Title>
		<String Name="n_pot">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="n_st">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="n_pan">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<Length Name="hpan">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Length>
		<Integer Name="type_ot">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Integer>
		<String Name="control_sum">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<RealNum Name="pl">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="pl_pt">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ssten">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="span">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</RealNum>
		<String Name="ROOM_NUMBER">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<Length Name="ROOM_PERIM">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Length>

		<!-- _sp5_B: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="_sp5_B">
			<Description><![CDATA["Трубопроводы"]]></Description>
		</Title>
		<Integer Name="eq_code">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Integer>
		<String Name="eq_plant">
			<Description><![CDATA[""]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
	</Parameters>
</ParamSection>

<Copyright SectVersion="1" SectionFlags="0" SubIdent="0">
	<Author></Author>
	<License>
		<Type>CC0</Type>
		<Version>1.0</Version>
	</License>
</Copyright>

<Keywords SectVersion="1" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Keywords>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Comment SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Comment>

</Symbol>
