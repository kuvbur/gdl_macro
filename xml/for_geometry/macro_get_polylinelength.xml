<?xml version="1.0" encoding="UTF-8"?>
<Symbol IsArchivable="false" IsPlaceable="false" MainGUID="78056419-D179-4E5F-95A4-645669258AB7" MigrationValue="Normal" Owner="1196638531" Signature="1196644685" Version="43">
<Ancestry SectVersion="1" SectionFlags="0" SubIdent="0" Template="false">
	<MainGUID>F938E33A-329D-4A36-BE3E-85E126820996</MainGUID>
	<MainGUID>103E8D2C-8230-42E1-9597-46F84CCE28C0</MainGUID>
</Ancestry>

<CalledMacros SectVersion="2" SectionFlags="0" SubIdent="0">
</CalledMacros>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_3D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_3D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_2D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_2D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_1D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
coord.error = "-"
EPS = 0.000001
dict polyth
length = 0


flag_data = 0

if bdict then 
	if haskey(coord.length) then _d = REMOVEKEY (coord.length)
	if haskey(coord.out) and flag_data = 0 then 
		polyth.in = coord.out
		flag_data = 1
	endif
	if haskey(coord.in) and flag_data = 0 then 
		polyth.in = coord.in
		flag_data = 1
	endif
	if flag_data = 0 then
		coord.error = "no data"
		goto "m_end"
	endif
else
	if vardim1(coord_arr)<2 then goto "m_end"
	for i=1 to vardim1(coord_arr)
		polyth.in[i].x = coord_arr[i][1]
		polyth.in[i].y = coord_arr[i][2]
		if vardim2(coord_arr)=3 then polyth.in[i].s = coord_arr[i][3]
	next i
endif

cx = 0 : cy = 0 : flag_r = 1 : r = 0
vx1 = 0 : vx2 = 0 : vy1 = 0 : vy2 = 0

for i=2 to vardim1(polyth.in)
	if haskey(polyth.in[i].s) then
		iStatus = int(polyth.in[i].s)
	else
		iStatus = 1
	endif
	if (iStatus > 0) then iStatus = iStatus - iStatus % 100
	if flag_r = 1 then 
		r = sqr((polyth.in[i].x-polyth.in[i-1].x)*(polyth.in[i].x-polyth.in[i-1].x) + (polyth.in[i].y-polyth.in[i-1].y)*(polyth.in[i].y-polyth.in[i-1].y))
		flag_r = 0
	endif
	if iStatus = 900 then flag_r = 1
	_length = 0
	if iStatus = 0 then _length = sqr((polyth.in[i].x-polyth.in[i-1].x)*(polyth.in[i].x-polyth.in[i-1].x) + (polyth.in[i].y-polyth.in[i-1].y)*(polyth.in[i].y-polyth.in[i-1].y))
	if iStatus = 4000 then _length = (PI * r * polyth.in[i].y)/180
	if iStatus = 3000 then
		vx1 = abs(polyth.in[i-2].x-polyth.in[i-1].x)
		vy1 = abs(polyth.in[i-2].y-polyth.in[i-1].y)
		vx2 = abs(polyth.in[i].x-polyth.in[i-1].x)
		vy2 = abs(polyth.in[i].y-polyth.in[i-1].y)
		t = (vx1*vx2+vy1*vy2)/(sqr(vx1*vx1+vy1*vy1)*sqr(vx2*vx2+vy2*vy2))
		if t < -1-EPS then t=-1
		if t>1+EPS then t= 1
		_length = (PI * r * acs(t))/180
		text2 polyth.in[i].x, polyth.in[i].y, _length
	endif
	length = length + _length
next i
coord.error = "ok"
goto "m_end"

"m_end":

if bdict then
	coord.length = length
	exit coord
else
	exit length
endif

]]>
</Script_1D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_PR SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_PR>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_UI SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_UI>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_VL SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_VL>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_FWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_FWM>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_BWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_BWM>

<ParamSection SectVersion="27" SectionFlags="0" SubIdent="0">
	<ParamSectHeader>
		<AutoHotspots>false</AutoHotspots>
		<StatBits>
			<STBit_FixSize/>
		</StatBits>
		<WDLeftFrame>0</WDLeftFrame>
		<WDRightFrame>0</WDRightFrame>
		<WDTopFrame>0</WDTopFrame>
		<WDBotFrame>0</WDBotFrame>
		<LayFlags>65535</LayFlags>
		<WDMirrorThickness>0</WDMirrorThickness>
		<WDWallInset>0</WDWallInset>
	</ParamSectHeader>
	<Parameters>
		<Length Name="A">
			<Description><![CDATA["Размер 1"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="B">
			<Description><![CDATA["Размер 2"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="ZZYZX">
			<Description><![CDATA["Высота"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Boolean Name="AC_show2DHotspotsIn3D">
			<Description><![CDATA["Показ Узловых 2D Точек в 3D"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Length Name="ac_bottomlevel">
			<Description><![CDATA["Отметка Низа"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="ac_toplevel">
			<Description><![CDATA["Отметка Верха"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Dictionary Name="coord">
			<Description><![CDATA[""]]></Description>
			<Value/>
		</Dictionary>
		<Length Name="coord_arr">
			<Description><![CDATA[""]]></Description>
			<ArrayValues FirstDimension="1" SecondDimension="3">
				<AVal Column="1" Row="1">0</AVal>
				<AVal Column="2" Row="1">0</AVal>
				<AVal Column="3" Row="1">0</AVal>
			</ArrayValues>
		</Length>
		<Boolean Name="bdict">
			<Description><![CDATA[""]]></Description>
			<Value>1</Value>
		</Boolean>
	</Parameters>
</ParamSection>

<Copyright SectVersion="1" SectionFlags="0" SubIdent="0">
	<Author></Author>
	<License>
		<Type>CC BY</Type>
		<Version>4.0</Version>
	</License>
</Copyright>

<Keywords SectVersion="1" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Keywords>

<Comment SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Comment>

</Symbol>


