<?xml version="1.0" encoding="UTF-8"?>
<Symbol IsArchivable="false" IsPlaceable="false" MainGUID="DDAA950F-D2BF-4719-B4B4-38F4675419B4" MigrationValue="Normal" Owner="1196638531" Signature="1196644685" Version="43">
<Ancestry SectVersion="1" SectionFlags="0" SubIdent="0" Template="false">
	<MainGUID>F938E33A-329D-4A36-BE3E-85E126820996</MainGUID>
	<MainGUID>103E8D2C-8230-42E1-9597-46F84CCE28C0</MainGUID>
</Ancestry>

<CalledMacros SectVersion="2" SectionFlags="0" SubIdent="0">
</CalledMacros>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_3D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_3D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_2D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_2D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_1D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
EPS = 0.0001

TO_XYZ = 1
TO_RPE = 2

r = 0 : etta = 0 : phi = 0
x = 0 : y = 0 : z = 0
dx = 0 : dy = 0 : dz = 0
type = 0
if bDict then
	if type = 0 then
		if haskey(line_dict.start.x) and haskey(line_dict.start.y) and haskey(line_dict.start.z) and haskey(line_dict.end.x) and haskey(line_dict.end.y) and haskey(line_dict.end.z) then
			type = TO_RPE
		endif
		if haskey(line_dict.r) and haskey(line_dict.phi) and haskey(line_dict.etta) and type = 0 then
			type = TO_XYZ
		endif
	endif
	if type = TO_RPE and not(haskey(line_dict.start.x) and haskey(line_dict.start.y) and haskey(line_dict.start.z) and haskey(line_dict.end.x) and haskey(line_dict.end.y) and haskey(line_dict.end.z)) then goto "m_end"
	if type = TO_XYZ and not(haskey(line_dict.r) and haskey(line_dict.phi) and haskey(line_dict.etta)) then goto "m_end"
	
	if type = TO_XYZ then
		r = line_dict.r
		phi = line_dict.phi
		etta = line_dict.etta
		gosub "rphitoxy"
		line_dict.end.x = x
		line_dict.end.y = y
		line_dict.end.z = z
	endif
	if type = TO_RPE then
		dx = line_dict.end.x - line_dict.start.x
		dy = line_dict.end.y - line_dict.start.y
		dz = line_dict.end.z - line_dict.start.z
		gosub "xytorphi"
		line_dict.r = r
		line_dict.phi = phi
		line_dict.etta = etta
	endif
else
	if type = TO_XYZ then
		gosub "rphitoxy"
		line_arr[2][1] = x
		line_arr[2][2] = y
		line_arr[2][3] = z
	endif
	if type = TO_RPE then
		dx = line_arr[2][1] - line_arr[1][1]
		dy = line_arr[2][2] - line_arr[1][2]
		dz = line_arr[2][3] - line_arr[1][3]
		gosub "xytorphi"
	endif
endif
goto "m_end"

"xytorphi":
	r = SQR(dx*dx+dy*dy+dz*dz)
	if r>EPS then
		if dx>0 and dy>=0 then phi = atn(dy/dx)
		if dx>0 and dy<0 then phi = atn(dy/dx)+360
		if dx<0 then phi = atn(dy/dx)+180
		if abs(dx)<EPS and dy>0 then phi = 90
		if abs(dx)<EPS and dy<0 then phi = 270
		if abs(dx)<EPS and abs(dy)<EPS then phi = 0
		if abs(r)>EPS then
			etta = acs(dz/r)
		else
			etta = 0
		endif
	else
		etta = 0
		phi = 0
	endif
return

"rphitoxy":
	x = r * sin(etta) * cos(phi)
	y = r * sin(etta) * sin(phi)
	z = r * cos(etta)
return

"m_end":
if bDict then
	exit line_dict
else
	if type = TO_XYZ then
		exit line_arr
	endif
	if type = TO_RPE then
		exit r, etta, phi
	endif
endif
]]>
</Script_1D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_PR SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_PR>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_UI SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_UI>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_VL SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_VL>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_FWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_FWM>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_BWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_BWM>

<ParamSection SectVersion="27" SectionFlags="0" SubIdent="0">
	<ParamSectHeader>
		<AutoHotspots>false</AutoHotspots>
		<StatBits>
			<STBit_FixSize/>
		</StatBits>
		<WDLeftFrame>0</WDLeftFrame>
		<WDRightFrame>0</WDRightFrame>
		<WDTopFrame>0</WDTopFrame>
		<WDBotFrame>0</WDBotFrame>
		<LayFlags>65535</LayFlags>
		<WDMirrorThickness>0</WDMirrorThickness>
		<WDWallInset>0</WDWallInset>
	</ParamSectHeader>
	<Parameters>
		<Length Name="A">
			<Description><![CDATA["Размер 1"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="B">
			<Description><![CDATA["Размер 2"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="ZZYZX">
			<Description><![CDATA["Высота"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Boolean Name="AC_show2DHotspotsIn3D">
			<Description><![CDATA["Показ Узловых 2D Точек в 3D"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Length Name="ac_bottomlevel">
			<Description><![CDATA["Отметка Низа"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="ac_toplevel">
			<Description><![CDATA["Отметка Верха"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Dictionary Name="line_dict">
			<Description><![CDATA[""]]></Description>
			<Value/>
		</Dictionary>
		<Length Name="line_arr">
			<Description><![CDATA[""]]></Description>
			<ArrayValues FirstDimension="2" SecondDimension="3">
				<AVal Column="1" Row="1">0</AVal>
				<AVal Column="2" Row="1">0</AVal>
				<AVal Column="3" Row="1">0</AVal>
				<AVal Column="1" Row="2">0</AVal>
				<AVal Column="2" Row="2">0</AVal>
				<AVal Column="3" Row="2">0</AVal>
			</ArrayValues>
		</Length>
		<Integer Name="type">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Integer>
		<Length Name="r">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Length>
		<Angle Name="etta">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Angle>
		<Angle Name="phi">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Angle>
		<Length Name="bDict">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Length>
	</Parameters>
</ParamSection>

<Copyright SectVersion="1" SectionFlags="0" SubIdent="0">
	<Author></Author>
	<License>
		<Type>CC BY</Type>
		<Version>4.0</Version>
	</License>
</Copyright>

<Keywords SectVersion="1" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Keywords>

<Comment SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Comment>

</Symbol>


