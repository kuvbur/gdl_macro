<?xml version="1.0" encoding="UTF-8"?>
<Symbol IsArchivable="false" IsPlaceable="false" MainGUID="3125DC48-6D84-4FDF-845F-AAB4646FF1E4" MigrationValue="Normal" Owner="1196638531" Signature="1196644685" Version="43">
<Ancestry SectVersion="1" SectionFlags="0" SubIdent="0" Template="false">
	<MainGUID>F938E33A-329D-4A36-BE3E-85E126820996</MainGUID>
	<MainGUID>103E8D2C-8230-42E1-9597-46F84CCE28C0</MainGUID>
</Ancestry>

<CalledMacros SectVersion="2" SectionFlags="0" SubIdent="0">
</CalledMacros>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_3D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_3D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_2D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_2D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_1D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
!dict coord_rotate
!call "macro_rotate" parameters coord = ogr_data.st.set.path ,ang = 60, axis = 1, bDict=1, RETURNED_PARAMETERS coord_rotate


EPS = 0.0001
dim rot_arr[3][3]
dim _arr[][]
dim _t[][]

ROT_X = 1
ROT_Y = 2
ROT_Z = 3

if bDict then
	coord.error = "-"
	if not(haskey(coord.in)) then goto "m_end"
	if vardim1(coord.in)<2 then goto "m_end"
	if abs(ang)<EPS then
		if haskey(coord.out) then _d = REMOVEKEY (coord.out)
		coord.out = coord.in
		coord.error = "ok"
		goto "m_end"
	endif
	if haskey(coord.ang) then ang = coord.ang
	if haskey(coord.axis) then axis = coord.axis
	for i=1 to vardim1(coord.in)
		if haskey(coord.in[i].x) then
			_arr[i][1] = coord.in[i].x
		else
			_arr[i][1] = 0
		endif
		if haskey(coord.in[i].y) then
			_arr[i][2] = coord.in[i].y
		else
			_arr[i][2] = 0
		endif
		if haskey(coord.in[i].z) then
			_arr[i][3] = coord.in[i].z
		else
			_arr[i][3] = 0
		endif
	next i
else
	_arr = coord_arr
endif

if abs(ang)<EPS then goto "m_end"

dim rot_arr[3][3]
if axis = ROT_X then
	i=0
	i=i+1 : rot_arr[i][1]=1 : rot_arr[i][2]=0 : rot_arr[i][3]=0
	i=i+1 : rot_arr[i][1]=0 : rot_arr[i][2]=cos(ang) : rot_arr[i][3]=-sin(ang)
	i=i+1 : rot_arr[i][1]=0 : rot_arr[i][2]=sin(ang) : rot_arr[i][3]=cos(ang)
endif

if axis = ROT_Y then
	i=0
	i=i+1 : rot_arr[i][1]=cos(ang)	: rot_arr[i][2]=0	: rot_arr[i][3]=sin(ang)
	i=i+1 : rot_arr[i][1]=0			: rot_arr[i][2]=1	: rot_arr[i][3]=0
	i=i+1 : rot_arr[i][1]=-sin(ang)	: rot_arr[i][2]=0	: rot_arr[i][3]=cos(ang)
endif

if axis = ROT_Z then
	i=0
	i=i+1 : rot_arr[i][1]=cos(ang) : rot_arr[i][2]=-sin(ang) : rot_arr[i][3]=0
	i=i+1 : rot_arr[i][1]=sin(ang) : rot_arr[i][2]=cos(ang) : rot_arr[i][3]=0
	i=i+1 : rot_arr[i][1]=0 : rot_arr[i][2]=0 : rot_arr[i][3]=1
endif

dim _t[][]
for i=1 to vardim1(_arr)
	for j=1 to 3
		_t[i][j] = 0
		for k=1 to 3
			_t[i][j] = _t[i][j] + _arr[i][k] * rot_arr[k][j]
		next k
	next j
next i

if bDict then
	if haskey(coord.out) then _d = REMOVEKEY (coord.out)
	coord.out = coord.in
	for i=1 to vardim1(_t)
		coord.out[i].x = _t[i][1]
		coord.out[i].y = _t[i][2]
		coord.out[i].z = _t[i][3]
	next i
	coord.error = "ok"
else
	coord_arr = _t
endif

"m_end":
if bDict then
	exit coord
else
	exit coord_arr
endif
]]>
</Script_1D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_PR SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_PR>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_UI SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_UI>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_VL SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_VL>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_FWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_FWM>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_BWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_BWM>

<ParamSection SectVersion="27" SectionFlags="0" SubIdent="0">
	<ParamSectHeader>
		<AutoHotspots>false</AutoHotspots>
		<StatBits>
			<STBit_FixSize/>
		</StatBits>
		<WDLeftFrame>0</WDLeftFrame>
		<WDRightFrame>0</WDRightFrame>
		<WDTopFrame>0</WDTopFrame>
		<WDBotFrame>0</WDBotFrame>
		<LayFlags>65535</LayFlags>
		<WDMirrorThickness>0</WDMirrorThickness>
		<WDWallInset>0</WDWallInset>
	</ParamSectHeader>
	<Parameters>
		<Length Name="A">
			<Description><![CDATA["Размер 1"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="B">
			<Description><![CDATA["Размер 2"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="ZZYZX">
			<Description><![CDATA["Высота"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Boolean Name="AC_show2DHotspotsIn3D">
			<Description><![CDATA["Показ Узловых 2D Точек в 3D"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Length Name="ac_bottomlevel">
			<Description><![CDATA["Отметка Низа"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="ac_toplevel">
			<Description><![CDATA["Отметка Верха"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Dictionary Name="coord">
			<Description><![CDATA[""]]></Description>
			<Value/>
		</Dictionary>
		<Length Name="coord_arr">
			<Description><![CDATA[""]]></Description>
			<ArrayValues FirstDimension="1" SecondDimension="3">
				<AVal Column="1" Row="1">0</AVal>
				<AVal Column="2" Row="1">0</AVal>
				<AVal Column="3" Row="1">0</AVal>
			</ArrayValues>
		</Length>
		<Angle Name="ang">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Angle>
		<Integer Name="axis">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Integer>
		<Boolean Name="bDict">
			<Description><![CDATA[""]]></Description>
			<Value>1</Value>
		</Boolean>
	</Parameters>
</ParamSection>

<Copyright SectVersion="1" SectionFlags="0" SubIdent="0">
	<Author></Author>
	<License>
		<Type>CC BY</Type>
		<Version>4.0</Version>
	</License>
</Copyright>

<Keywords SectVersion="1" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Keywords>

<Comment SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Comment>

</Symbol>


