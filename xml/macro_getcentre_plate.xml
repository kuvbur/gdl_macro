<?xml version="1.0" encoding="UTF-8"?>
<Symbol IsArchivable="false" IsPlaceable="false" MainGUID="1C42D245-FB64-4C75-A29D-93F12092321A" MigrationValue="Normal" Owner="1196638531" Signature="1196644685" Version="43">
<Ancestry SectVersion="1" SectionFlags="0" SubIdent="0" Template="false">
	<MainGUID>F938E33A-329D-4A36-BE3E-85E126820996</MainGUID>
	<MainGUID>103E8D2C-8230-42E1-9597-46F84CCE28C0</MainGUID>
	<MainGUID>B2970E4C-8680-4061-8670-2F4B638F3953</MainGUID>
</Ancestry>

<CalledMacros SectVersion="2" SectionFlags="0" SubIdent="0">
</CalledMacros>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_3D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_3D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_2D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_2D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_1D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
dim vertArray[][]
dim contourArray[]
dim resPolyIDArray[] : resPolyIDArray[1] = ""
dim contArr[] : dim resVertices[]
ch = INITADDONSCOPE ("PolyOperations", "", "")
PREPAREFUNCTION ch, "CreateContainer", "from_cont", ""
PREPAREFUNCTION ch, "CreateContainer", "to_cont", ""
PREPAREFUNCTION ch, "SetSourceContainer",		"from_cont", ""
PREPAREFUNCTION ch, "SetDestinationContainer",	"to_cont", ""

l = 0
max_l = 0
vl_x = 0
vl_y = 0
ssumx = 0
ssumy = 0
for i=1 to k_otr_pl
	x = otr_pl[i][1]
	y = otr_pl[i][2]
	if i<k_otr_pl then
		ssumx = ssumx + (otr_pl[i][1] + otr_pl[i+1][1])*(otr_pl[i][1]*otr_pl[i+1][2]-otr_pl[i+1][1]*otr_pl[i][2])
		ssumy = ssumy + (otr_pl[i][2] + otr_pl[i+1][2])*(otr_pl[i][1]*otr_pl[i+1][2]-otr_pl[i+1][1]*otr_pl[i][2])
	endif
	l = sqr(x*x + y*y)
	if l >= max_l then
		vl_x = x
		vl_y = y
		max_l = l
	endif
next i

for i=1 to k_otr_pl
	x = otr_pl[i][1]
	y = otr_pl[i][2]
	hotspot2 x,y
	l = sqr((x-vl_x)*(x-vl_x) + (y-vl_y)*(y-vl_y))
	if l>= max_l then
		nl_x = x
		nl_y = y
		max_l = l
	endif
next i

!---------------Площадь плиты без отверстий
for i=1 to k_otr_pl
	for j = 1 to 4
		otr_pl[i][j] = int(otr_pl[i][j]*1000)/1000
	next j
next i

for i = 1 to k_otv
	if i = 1 then n_perv = 1
	if i>1 then n_perv=k_otr_otv[k_otv-1]+1
	for j=1 to k_otr_otv[i]
		for k = 1 to 4
			otr_otv[n_perv+j][k] = int(otr_otv[n_perv+j][k]*1000)/1000
		next k
	next j
next i

s_plit_obsh = 0
for i=1 to k_otr_pl-1
	if abs(otr_pl[i][1] - otr_pl[i+1][1])>EPS or abs(otr_pl[i][2] - otr_pl[i+1][2])>EPS then
		s_t = 0.5*((otr_pl[i+1][1]-otr_pl[i][1])*(otr_pl[i][2]-otr_pl[1][2])-(otr_pl[i][1]-otr_pl[1][1])*(otr_pl[i+1][2]-otr_pl[i][2]))
		s_plit_obsh = s_plit_obsh+s_t
	endif
next i
s_plit_sgn = s_plit_obsh
s_plit_obsh = abs(s_plit_obsh)

perim = 0
for i=1 to k_otr_pl
	l = SQR(((otr_pl[i][3]-otr_pl[i][1])**2)+((otr_pl[i][4]-otr_pl[i][2])**2))
	perim = perim + l
next i
!---------------Площадь отверстий
area_obsh = 0
if k_otv>=1 then
	for i = 1 to k_otv
		if i = 1 then n_perv = 1
		if i>1 then n_perv=k_otr_otv[k_otv-1]+1
		for j=1 to k_otr_otv[i] - 2
			if abs(otr_otv[n_perv+j][1]-otr_otv[n_perv+j+1][1])>EPS or abs(otr_otv[n_perv+j][2]-otr_otv[n_perv+j+1][2])>EPS then
				s_t = 0.5*((otr_otv[n_perv+j+1][1]-otr_otv[n_perv+j][1])*(otr_otv[n_perv+j][2]-otr_otv[n_perv][2])-(otr_otv[n_perv+j][1]-otr_otv[n_perv][1])*(otr_otv[n_perv+j+1][2]-otr_otv[n_perv+j][2]))
				area_obsh = round_int((area_obsh + abs(s_t)) * 1000) / 1000
			endif
		next j
	next i
endif

whole_poly = "poly2"
nVertices = 0
nContours = 0
for i = 1 to k_otr_pl
	nVertices = nVertices + 1
	vertArray[nVertices][1] = otr_pl[i][1]
	vertArray[nVertices][2] = otr_pl[i][2]
	vertArray[nVertices][3] = 0
next i
nVertices = nVertices + 1
vertArray[nVertices][1] = otr_pl[k_otr_pl][3]
vertArray[nVertices][2] = otr_pl[k_otr_pl][4]
vertArray[nVertices][3] = 0
nContours = nContours + 1
contourArray[nContours] = nVertices
if k_otv>0 then
	for j = 1 to k_otv
		if j = 1 then n_perv = 1
		if j>1 then n_perv = k_otr_otv[k_otv - 1] + 1
		for i = 1 to k_otr_otv[j] - 1
			nVertices = nVertices + 1
			vertArray[nVertices][1] = otr_otv[n_perv + i][1]
			vertArray[nVertices][2] = otr_otv[n_perv + i][2]
			vertArray[nVertices][3] = 0
		next i
		nVertices = nVertices + 1
		vertArray[nVertices][1] = otr_otv[n_perv + k_otr_otv[j] - 1][3]
		vertArray[nVertices][2] = otr_otv[n_perv + k_otr_otv[j] - 1][4]
		vertArray[nVertices][3] = 0
		nVertices = nVertices + 1
		vertArray[nVertices][1] = otr_otv[n_perv + 1][1]
		vertArray[nVertices][2] = otr_otv[n_perv + 1][2]
		vertArray[nVertices][3] = 0
		nContours = nContours + 1
		contourArray[nContours] = nVertices
	next j
endif
PREPAREFUNCTION ch, "Store", whole_poly, nVertices, nContours, vertArray, contourArray
nPgon = CALLFUNCTION (ch, "Regularize", whole_poly, resPolyIDArray)
rezult = CALLFUNCTION (ch, "CentreOfGravity", whole_poly, ch_x, ch_y)
CLOSEADDONSCOPE (ch)
if rezult<EPS then
	ch_x = ssumx / (6 * s_plit_sgn)
	ch_y = ssumy / (6 * s_plit_sgn)
endif

end ch_x, ch_y, perim, s_plit_obsh, area_obsh
]]>
</Script_1D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_PR SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_PR>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_UI SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_UI>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_VL SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_VL>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_FWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_FWM>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_BWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_BWM>

<ParamSection SectVersion="26" SectionFlags="0" SubIdent="0">
	<ParamSectHeader>
		<AutoHotspots>false</AutoHotspots>
		<StatBits>
			<STBit_FixSize/>
		</StatBits>
		<WDLeftFrame>0</WDLeftFrame>
		<WDRightFrame>0</WDRightFrame>
		<WDTopFrame>0</WDTopFrame>
		<WDBotFrame>0</WDBotFrame>
		<LayFlags>65535</LayFlags>
		<WDMirrorThickness>0</WDMirrorThickness>
		<WDWallInset>0</WDWallInset>
	</ParamSectHeader>
	<Parameters>
		<Length Name="A">
			<Description><![CDATA["Размер 1"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="B">
			<Description><![CDATA["Размер 2"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="ZZYZX">
			<Description><![CDATA["Высота"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Boolean Name="AC_show2DHotspotsIn3D">
			<Description><![CDATA["Показ Узловых 2D Точек в 3D"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Length Name="ac_bottomlevel">
			<Description><![CDATA["Отметка Низа"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="ac_toplevel">
			<Description><![CDATA["Отметка Верха"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="otr_pl">
			<Description><![CDATA[""]]></Description>
			<ArrayValues FirstDimension="1" SecondDimension="2">
				<AVal Column="1" Row="1">0</AVal>
				<AVal Column="2" Row="1">0</AVal>
			</ArrayValues>
		</Length>
		<Integer Name="k_otr_pl">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Integer>
		<Integer Name="k_otv">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Integer>
		<Integer Name="k_otr_otv">
			<Description><![CDATA[""]]></Description>
			<ArrayValues FirstDimension="1" SecondDimension="0">
				<AVal Row="1">0</AVal>
			</ArrayValues>
		</Integer>
		<Length Name="otr_otv">
			<Description><![CDATA[""]]></Description>
			<ArrayValues FirstDimension="1" SecondDimension="2">
				<AVal Column="1" Row="1">0</AVal>
				<AVal Column="2" Row="1">0</AVal>
			</ArrayValues>
		</Length>
		<Length Name="ch_x">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Length>
		<Length Name="ch_y">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Length>
		<Length Name="perim">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Length>
		<RealNum Name="s_plit_obsh">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="area_obsh">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</RealNum>
	</Parameters>
</ParamSection>

<Copyright SectVersion="1" SectionFlags="0" SubIdent="0">
	<Author></Author>
	<License>
		<Type>CC0</Type>
		<Version>1.0</Version>
	</License>
</Copyright>

<Keywords SectVersion="1" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Keywords>

<Comment SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Comment>

</Symbol>
